<!DOCTYPE html>
<html lang="en-US">

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon">
    <meta name="description" content="CropData's AEFC program is for traders, food processors, exports, stockists, etc, who play the essential role of market makers in the industry and provide the much-needed liquidity through their knowledge and experience.">
    <meta name="keywords" content="CropData, Agriculture Services, Agriculture service providers, Farming services, Krishi, Dr. Krishi, Agriculture E-Marketplace">
    <meta name="author" content="Sachin Suri - MD, CropData, Designed & Developed by Prakash Patil">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>CropData | Agriota Verification</title>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@300;400;600;700;800&display=swap" rel="stylesheet" />
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css" />
    <link type="text/css" rel="stylesheet" href="/css/jquery.jConveyorTicker.min.css" />
    <link type="text/css" rel="stylesheet" href="/css/ticker-styles.css" />
    <link rel="stylesheet" type="text/css" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="/css/main.css" />

    <!-- Facebook Meta Tags -->
    <meta property="og:url" content="https://cropdata.in/agriota-user/verification.html">
    <meta property="og:type" content="website">
    <meta property="og:title" content="CropData | Agriota Verification">
    <meta property="og:description" content="CropData's AEFC program is for traders, food processors, exports, stockists, etc, who play the essential role of market makers in the industry and provide the much-needed liquidity through their knowledge and experience.">
    <meta property="og:image" content="https://cropdata.in/images/og-logo.png">

    <!-- Twitter Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta property="twitter:domain" content="cropdata.in">
    <meta property="twitter:url" content="https://cropdata.in/agriota-user/verification.html">
    <meta name="twitter:title" content="CropData | Agriota Verification">
    <meta name="twitter:description" content="CropData's AEFC program is for traders, food processors, exports, stockists, etc, who play the essential role of market makers in the industry and provide the much-needed liquidity through their knowledge and experience.">
    <meta name="twitter:image" content="https://cropdata.in/images/og-logo.png">

    <!-- IE function that returns browser is Internet Explorer-->
    <script>
        function isIE() {
            ua = navigator.userAgent;
            /* MSIE used to detect old browsers and Trident used to newer ones*/
            var is_ie = ua.indexOf("MSIE ") > -1 || ua.indexOf("Trident/") > -1;
            return is_ie;
        }
        /* Check and redirect to another page */
        if (isIE()) {
            location.replace("compatible-browsers.html");
        }
    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-176736470-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];

        function gtag() {
            dataLayer.push(arguments);
        }
        gtag('js', new Date());

        gtag('config', 'UA-176736470-1');
    </script>

</head>

<body>
    <div id="loading">
        <div id="loading-center">
            <div id="loading-center-absolute">
                <img alt="" src="/images/cropdata-logo-blue.svg" class="img-fluid" />
            </div>
        </div>
    </div>
    <main>
        <header id="js-header">
            <div class="container menu-bar-container">
                <div class="row align-items-center">
                    <div class="col-12 col-sm-12 col-md-2 col-lg-2 col-xl-2 logo-section">
                        <a href="/index.html" class="home-logo"><img alt="" src="/images/cropdata-logo-white.svg" class="img-fluid" /></a>
                        <a href="/index.html" class="other-logo"><img alt="" src="/images/cropdata-logo-blue.svg" class="img-fluid" /></a>
                        <a class="btn btn-primary nav-toggle"><i class="fas fa-bars"></i></a>
                    </div>
                    <div class="col-12 col-sm-12 col-md-10 col-lg-10 col-xl-10 menu-bar">
                        <ul class="nav-menu">
                            <li><a href="/index.html">Home</a></li>
                            <li><a href="/about.html">About Us</a></li>
                            <li class="submenu_parent">
                                <a class="mouse-pointer">Platforms <i class="fa fa-angle-down" aria-hidden="true"></i></a>
                                <ul class="submenu">
                                    <li><a href="/dr-krishi.html">Dr. Krishi</a></li>
                                    <li><a href="/agdata.html">AgData</a></li>
                                    <li><a href="/agriota.html">Agriota</a></li>
                                    <li><a href="/krishiCo.html">KrishiCo</a></li>
                                </ul>
                            </li>
                            <li><a href="/products.html">Products & Services</a></li>
                            <li><a href="/partners.html">Partners</a></li>
                            <li class="submenu_parent">
                                <a class="mouse-pointer">CropData <i class="fa fa-angle-down" aria-hidden="true"></i></a>
                                <ul class="submenu">
                                    <li><a href="/news.html">News</a></li>
                                    <li><a href="/csr.html">CSR</a></li>
                                    <li><a href="/agriota.html#agriota-commodity" data-offset="180">Commodities</a></li>
                                    <li><a href="/market-data.html">Market Data</a></li>
                                    <li><a href="/career.html">Careers</a></li>
                                    <li><a href="/contact.html">Contact</a></li>
                                    <li><a href="/agriota-user.html">Join Us</a></li>
                                </ul>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </header>

        <section class="banner" style="background-color: #486018;">
            <picture>
                <source srcset="/images/franchise-banner.jpg" media="(min-width: 1024px)" class="img-fluid" />
                <source srcset="/images/franchise-banner-medium.jpg" media="(min-width: 400px)" class="img-fluid" />
                <source srcset="/images/franchise-banner-small.jpg" media="(min-width: 230px)" class="img-fluid" />
                <img alt="" src="/images/franchise-banner.jpg" width="100%" class="img-fluid" />
            </picture>
        </section>



        <section class="">
            <div class="container contact-section">
                <div class="row right_side">
                    <div class="franchise-form-box formWhiteBox col-12">

                        <div class="form-box verificationList">
                            <h2 class="section-title text-center title-border mb-3 pb-1">Verification</h2>
                            <h5>Email</h5>
                            <h6 class="emailVerificationStatusContainer status">
                                <div class="d-flex align-items-center justify-content-center">
                                    <i class="fas fa-envelope"></i>
                                    <span class="userEmail"></span>
                                </div>
                                <span class="verificationStatus emailVerificationStatus"></span></h6>
                            <h5>Mobile Number</h5>
                            <h6 class="mobileVerificationStatusContainer status">
                                <div class="d-flex align-items-center justify-content-center">
                                    <i class="fas fa-mobile-alt"></i> <span class="userMobile"></span>
                                </div>
                                <span class="verificationStatus mobileVerificationStatus"></span></h6>
                            </h6>

                            <hr>

                            <div class="optverifiedSection">
                                <h6>Enter OTP to complete verification process</h6>

                                <form action="" method="POST" enctype="multipart/form-data" class="Pre-Application-box" id="mobileNoVerificationForm" novalidate>
                                    <div class="form-group loginOtpField" title="Enter OTP">
                                        <label for="verificationOtp">OTP <span class="required">*</span></label>
                                        <input type="number" onkeypress="if(this.value.length==4) return false;" class="form-control" name="verificationOtp" id="verificationOtp" placeholder="Enter OTP">
                                    </div>
                                    <!--Submit-->
                                    <div class="form-group d-flex justify-content-between align-items-center m-0">
                                        <input type="submit" id="mobileNoVerificationFormBtn" value="Submit" class="btn btn-primary btn-lg" />
                                        <button type="button" id="resendOtp" class="btn btn-primary btn-md"><i class="fas fa-redo-alt"></i> <span>Resend OTP</span></button>
                                    </div>
                                </form>
                            </div>

                            <div id="infoArea" class="alert alert-warning d-none m-0">
                                <div class="d-flex justify-content-center align-items-center">
                                    <i class="fas fa-exclamation-triangle mr-3" style="font-size: 60px;"></i>
                                    <p class="m-0"> Please open your email client and check for a new email from Cropdata. Click on the verify button to start accessing your account. Not found?
                                        <a href="#" id="resendMail" style="text-decoration: underline; font-weight: 600;">Resend Verification Email</a>
                                    </p>
                                </div>
                            </div>
                            <!-- <div type="button" class="w-100 btn btn-dark">Resend Verification Email</a> -->


                            <!-- <p>Please feel free to contact us if you have any Query.</p> -->
                            <!-- <form id="contact-form" class="contact-form-container" onsubmit="return false" method="POST" enctype="multipart/form-data" novalidate="novalidate">
                                <div class="form-group">
                                    <label for="name">Full Name <span class="required">*</span></label>
                                    <input type="text" class="form-control" maxlength="45" name="name" id="name" placeholder="Full Name" required="">
                                </div>

                                <div class="form-group">
                                    <label for="email">Email <span class="required">*</span></label>
                                    <input type="email" maxlength="100" class="form-control" name="email" id="email" placeholder="Email" required="">
                                </div>

                                <div class="form-group">
                                    <label for="mobile">Mobile Number <span class="required">*</span></label>
                                    <input type="text" class="form-control" maxlength="18" name="mobile" id="mobile" placeholder="Mobile Number" required="">
                                </div>

                                <div class="form-group">
                                    <label for="query">Query</label>
                                    <textarea class="form-control" name="query" id="query" placeholder="Query"></textarea>
                                </div>

                                <div class="form-group">
                                    <button id="contact-form-btn" class="form-control w-auto btn btn-dark">Submit</button>
                                </div>
                            </form> -->
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section class="tech-contact dark">
            <div class="container text-center py-5">
                <h2 class="section-title text-center mb-3 title-border">Technical Support & Inquiry</h2>
                <div class="about p-0 mb-3">
                    <p class="para">Please feel free to contact us if you have any query or issue to connect with us.</p>
                </div>
                <div class="row justify-content-center">
                    <div class="col-12 col-sm-12 col-md-3">
                        <a href="tel:+917122249901">
                            <h1>
                                <i class="fas fa-mobile-alt"></i>
                            </h1>
                            <h5>+91-7122249901 - 06</h5>
                        </a>
                    </div>
                    <div class="col-12 col-sm-12 col-md-3">
                        <a href="mailto:info@cropdata.in" target="_blank">
                            <h1>
                                <i class="fas fa-envelope-open-text"></i>
                            </h1>
                            <h5>info@cropdata.in</h5>
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <div class="modal fade" id="formModalMsg">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h4 class="modal-title">Pre-Application Form Status</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>
                    <div class="modal-body"></div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-primary" data-dismiss="modal" onclick="location.reload()">Close</button>
                    </div>
                </div>
            </div>
        </div>
        <a id="back-to-top" class="btn btn-light btn-lg back-to-top" role="button"><i class="fas fa-chevron-up"></i></a>
        <footer></footer>
    </main>

    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js" integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q" crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>


    <script src="/js/main.js" type="text/javascript"></script>
    <script type="text/javascript" src="/js/ajax-loading.js"></script>

    <script src="https://ajax.aspnetcdn.com/ajax/jquery.validate/1.11.1/jquery.validate.min.js"></script>
    <script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/additional-methods.min.js"></script>

    <script>
        function showMessage(msg) {
            if (msg != "") {
                // alert("Failed to submit the form");
                setTimeout(function() {
                    $(".msg-box").append(msg).show();
                    if (
                        $('.msg-box:contains("' + msg + '")').length > 0
                    ) {
                        $(".msg-box").empty();
                        $(".msg-box").append(msg).show();
                    }
                }, 0);
                setTimeout(function() {
                    $(".msg-box").empty().hide();
                }, 3000);
            }
        }


        //Timer function for resend otp
        function timer(time) {
            // $('#resendOtp').show().prop("disabled", true);
            var timer2 = time;
            // var timer2 = '0:10';
            var interval = setInterval(function() {
                var timer = timer2.split(':');
                //by parsing integer, I avoid all extra string processing
                var minutes = parseInt(timer[0], 10);
                var seconds = parseInt(timer[1], 10);
                --seconds;
                minutes = (seconds < 0) ? --minutes : minutes;
                if (minutes < 0) clearInterval(interval);
                seconds = (seconds < 0) ? 59 : seconds;
                seconds = (seconds < 10) ? '0' + seconds : seconds;
                minutes = (minutes < 10) ? minutes : minutes;
                // $('.buyerLoginFormBtn').html(minutes + ':' + seconds);
                timer2 = minutes + ':' + seconds;

                if (timer2 == '-1:59') {
                    localStorage.removeItem("timer");
                    $('#resendOtp span').html('RESEND OTP');
                    if ($("#resendOtp").is(":disabled")) {
                        $('#resendOtp').removeAttr("disabled");
                    }

                } else {
                    localStorage.setItem("timer", timer2);
                    $('#resendOtp span').html('RESEND OTP ( ' + timer2 + ')');
                    $('#resendOtp').prop("disabled", true);
                }
            }, 1000)
        };

        $(document).ready(function() {

            if (localStorage.getItem("timer") != null) {
                timer(localStorage.getItem("timer"));
                $("#resendOtp").show().prop("disabled", true);
            } else {
                $("#resendOtp").show().removeAttr("disabled");
            };


            var loading = $.loading();
            setTimeout(function() {
                var otp = $('#verificationOtp').val();
                if (otp == "") {
                    location.reload();
                }
            }, 10000);


            // var verificationResquestUrl = "/agriota-user/verification.json";

            const urlParams = new URLSearchParams(window.location.search);

            var mob = urlParams.get('mob');
            var email = urlParams.get('email');
            // $('.userEmail').html(email);
            $('.userMobile').html(mob);

            $.ajax({
                type: "GET",
                url: aefcBaseUrl + "/verifiedUserDetails" + '/' + mob,
                contentType: "application/json; charset=utf-8",
                dataType: "json",
                async: true,
                success: function(response) {

                    email = response.EmailId;


                    $('.userMobile').html(response.isdCode + ' ' + $('.userMobile').text());

                    $('.userEmail').html(email);

                    if (response.IsEmailVerified == "Yes" && response.IsMobileVerified == "Yes") {
                        document.location.href = "/agriota-user.html"
                    }

                    $('.emailVerificationStatus').addClass(response.email_status);
                    $('.mobileVerificationStatus').addClass(response.mobile_status);

                    if (response.IsEmailVerified == "Yes") {
                        $('.emailVerificationStatusContainer').addClass("active");
                        $('.emailVerificationStatusContainer .verificationStatus').html("Verified");
                        $('.emailVerificationStatusContainer .verificationStatus').addClass("verified");
                    } else {
                        $('.emailVerificationStatusContainer').addClass("inactive");
                        $('.emailVerificationStatusContainer .verificationStatus').html("Unverified");
                        $('.emailVerificationStatusContainer .verificationStatus').addClass("unverified");
                    }

                    if (response.IsMobileVerified == "Yes") {
                        $('.mobileVerificationStatusContainer').addClass("active");
                        $('.mobileVerificationStatusContainer .verificationStatus').html("Verified");
                        $('.mobileVerificationStatusContainer .verificationStatus').addClass("verified");
                        // Remove otp form
                        $('.optverifiedSection').hide();
                        $('#infoArea').toggleClass('d-none');
                    } else {
                        $('.mobileVerificationStatusContainer').addClass("inactive");
                        $('.mobileVerificationStatusContainer .verificationStatus').html("Unverified");
                        $('.mobileVerificationStatusContainer .verificationStatus').addClass("unverified");
                    }

                },
                error: function(xhr, textStatus, errorThrown) {},
            });

            // Resend Verification Link to mail address
            $("#resendMail").on('click', function() {
                if (mob != '' && email != '') {
                    $.ajax({
                        type: "GET",
                        url: aefcBaseUrl + '/resendEmail/' + email + '/' + mob,
                        contentType: "application/json; charset=utf-8",
                        async: true,
                        beforeSend: function(xhr) {
                            loading.open();
                        },
                        success: function(response) {
                            loading.close();
                            if (response.status == true) {
                                showMessage("Please check your mail for verification link.");
                            } else {
                                showMessage("Email or mobile number not found");
                            }
                        },
                        error: function(xhr, textStatus, errorThrown) {
                            loading.close();
                            showMessage(xhr.responseJSON.error);
                        },
                    });
                } else {
                    showMessage("Email or mobile number not found");
                }
            });

            // Resend otp request
            $("#resendOtp").on('click', function() {
                var data = {
                    loginMobileNo: mob,
                    loginOtp: $("#verificationOtp").val(),
                };
                $.ajax({
                    type: "POST",
                    url: aefcBaseUrl + "/validateOTP",
                    contentType: "application/json; charset=utf-8",
                    data: JSON.stringify(data),
                    dataType: "json",
                    async: true,
                    beforeSend: function(xhr) {
                        loading.open();
                        $("#resendOtp").hide();
                    },
                    success: function(response) {
                        if (response.status == true) {
                            timer(response.expiredTime);
                            // timer('0:20');
                            $("#resendOtp").show().prop("disabled", true);
                        } else {
                            showMessage(response.message);
                            $("#resendOtp").show();
                        }
                    },
                    error: function(xhr, textStatus, errorThrown) {
                        loading.close();
                        $("#resendOtp").show();
                        showMessage(xhr.responseJSON.error);
                    },
                });
            });

            // override jquery validate plugin defaults
            $.validator.setDefaults({

                highlight: function(element) {
                    $(element).closest(".form-group").addClass("has-error");
                },
                unhighlight: function(element) {
                    $(element).closest(".form-group").removeClass("has-error");
                },
                errorElement: "span",
                errorClass: "help-block",
                errorPlacement: function(error, element) {
                    if (
                        element.parent(".input-group").length ||
                        element.parent().parent(".input-group").length
                    ) {
                        error.insertAfter(element.closest(".input-group"));
                    } else if (element.parent(".input-group").length) {
                        error.insertAfter(element.parent());
                    } else if (
                        element.prop("type") === "radio" &&
                        element.parent(".radio-inline").length
                    ) {
                        error.insertAfter(element.parent().parent());
                    } else if (
                        element.prop("type") === "checkbox" ||
                        element.prop("type") === "radio"
                    ) {
                        error.appendTo(element.parent().parent());
                    } else {
                        error.insertAfter(element);
                    }
                },
                submitHandler: function(element) {

                    var data = {
                        loginMobileNo: mob,
                        loginOtp: $("#verificationOtp").val(),
                    };

                    $.ajax({
                        type: "POST",
                        url: aefcBaseUrl + "/validateOTP",
                        // url: "http://192.168.0.50:8080/site/agriota-user/add",
                        contentType: "application/json; charset=utf-8",
                        data: JSON.stringify(data),
                        dataType: "json",
                        async: true,
                        beforeSend: function(xhr) {
                            loading.open();
                            $("#buyerLoginFormBtn").hide();
                            $("#formModalMsg .modal-body").empty();
                        },
                        success: function(response) {
                            if (response.status != undefined) {
                                if (response.status == true) {
                                    if (response.authToken != undefined && response.authToken != "") {
                                        document.location.href = '/agriota-user/registration.html?jwt=' + response.authToken;
                                    } else {
                                        location.reload();
                                    }
                                } else {
                                    showMessage(response.message);
                                    $('#verificationOtp').val('');
                                }
                            } else {
                                showMessage("Server error please try again later.");
                            }
                            loading.close();
                        },
                        error: function(xhr, textStatus, errorThrown) {
                            loading.close();
                            showMessage(xhr.responseJSON.error);
                        },
                    });

                },
            });

            if (jQuery().validate) {
                // registation form validation
                $("#mobileNoVerificationForm").validate({
                    rules: {
                        verificationOtp: {
                            required: true,
                            minlength: 4,
                            maxlength: 4,
                        },
                    },
                    messages: {
                        verificationOtp: {
                            required: jQuery.format("Please Enter OTP.")
                        }
                    },
                });
            }
        });
    </script>
</body>

</html>